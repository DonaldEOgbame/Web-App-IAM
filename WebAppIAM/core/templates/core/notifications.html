<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Notifications</title>
    <style>
        body {font-family: Arial, sans-serif;background:#f5f5f5;margin:0;padding:0;}
        .container {max-width:700px;margin:40px auto;background:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,0.1);}
        .alert {padding:10px;margin-bottom:10px;border-radius:4px;}
        .info {background:#d1ecf1;color:#0c5460;}
        .warning {background:#fff3cd;color:#856404;}
        .risk {background:#f8d7da;color:#721c24;}
    </style>
</head>
<body>
<div class="container">
    <h1>Your Notifications</h1>
    {% for n in notifications %}
        <div class="alert {{ n.notification_type|lower }}" data-id="{{ n.id }}">{{ n.message }} - {{ n.created_at }}</div>
    {% empty %}
        <p>No notifications.</p>
    {% endfor %}
    <a href="{% url 'core:staff_dashboard' if user.role == 'STAFF' else 'core:admin_dashboard' %}">Back to Dashboard</a>
</div>
<script>
(function(){
    const csrftoken = '{{ csrf_token }}';
    document.querySelectorAll('.alert[data-id]').forEach(function(el){
        el.addEventListener('click', function(){
            fetch('{% url "core:mark_notification_read" 0 %}'.replace('0', el.dataset.id), {
                method:'POST', headers:{'X-CSRFToken': csrftoken}
            }).then(()=>{ el.style.display='none'; });
        });
    });
})();
</script>
</body>
</html>
