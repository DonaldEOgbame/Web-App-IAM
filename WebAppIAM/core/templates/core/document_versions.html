<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document Versions - {{ document.title }}</title>
    <style>
        body{font-family:Arial, sans-serif;background:#f5f5f5;margin:0;}
        .container{max-width:960px;margin:40px auto;padding:20px;background:#fff;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.1);}
        h1{margin-top:0;text-align:center;}
        form.filters input{padding:6px;margin-right:10px;}
        table{width:100%;border-collapse:collapse;margin-top:20px;}
        th,td{padding:8px 12px;border-bottom:1px solid #ddd;text-align:left;}
        th{background:#f0f2f5;}
        .status-badge{padding:3px 8px;border-radius:4px;color:#fff;display:inline-block;font-size:0.85em;}
        .status-success{background:#2ecc71;}
        .status-danger{background:#e74c3c;}
        .status-warning{background:#f1c40f;color:#000;}
        .status-secondary{background:#95a5a6;}
    </style>
    <script>
        function restoreVersion(id, csrfToken){
            if(confirm('Restore this version?')){
                fetch('{% url "core:restore_document_version" 0 %}'.replace('0', id), {
                    method:'POST',
                    headers:{'X-CSRFToken': csrfToken}
                }).then(function(){ location.reload(); });
            }
        }
    </script>
</head>
<body>
<div class="container">
    <h1>Versions of {{ document.title }}</h1>
    <form method="get" class="filters">
        <input type="text" name="q" placeholder="Search" value="{{ query }}">
        <input type="date" name="date_from" value="{{ date_from }}">
        <input type="date" name="date_to" value="{{ date_to }}">
        <input type="number" name="version" min="1" placeholder="Version" value="{{ version }}">
        <button type="submit">Filter</button>
    </form>
    <table>
        <thead>
        <tr>
            <th>Version</th>
            <th>Uploaded</th>
            <th>Uploader</th>
            <th>Size</th>
            <th>Status</th>
            {% if user.role == 'ADMIN' %}<th>Actions</th>{% endif %}
        </tr>
        </thead>
        <tbody>
        {% for v in versions %}
        <tr>
            <td>{{ v.version }}</td>
            <td>{{ v.created_at }}</td>
            <td>{{ v.uploaded_by }}</td>
            <td>{{ v.file_size }} bytes</td>
            <td><span class="status-badge status-{{ v.get_status_class }}">{{ v.get_status }}</span></td>
            {% if user.role == 'ADMIN' %}
            <td>
                {% if v.deleted %}
                <button type="button" onclick="restoreVersion({{ v.id }}, '{{ csrf_token }}')">Restore</button>
                {% else %}-{% endif %}
            </td>
            {% endif %}
        </tr>
        {% empty %}
        <tr><td colspan="6">No versions found.</td></tr>
        {% endfor %}
        </tbody>
    </table>
</div>
</body>
</html>
