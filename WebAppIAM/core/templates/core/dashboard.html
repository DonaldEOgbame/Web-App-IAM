{% extends 'base.html' %}
{% block content %}
<div class="container dashboard-container glass" style="padding: 2.5em 2em; margin-top: 2em;">
  <h2 class="center" style="font-size:2.2em; margin-bottom:1.2em; letter-spacing:1px; background: linear-gradient(90deg,#6c63ff,#48c6ef);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;">Welcome to Your Dashboard</h2>
  <div class="card shadow mb-3 glass" style="backdrop-filter: blur(6px);">
    <h3 class="center" style="font-size:1.3em;">Recent Sessions</h3>
    <div class="table-responsive">
      <table class="modern-table" style="border-radius:12px;overflow:hidden;">
        <thead>
          <tr style="background:linear-gradient(90deg,#e3e9f7,#f8fafc);">
            <th>Date/Time</th>
            <th>IP</th>
            <th>Device</th>
            <th>Face Match</th>
            <th>Fingerprint</th>
            <th>Risk</th>
          </tr>
        </thead>
        <tbody>
          {% for session in sessions %}
          <tr style="transition:background 0.2s;">
            <td>{{ session.login_time|date:'Y-m-d H:i' }}</td>
            <td>{{ session.ip_address }}</td>
            <td title="{{ session.user_agent }}">{{ session.user_agent|truncatechars:18 }}</td>
            <td>{{ session.face_match_score|default:'-' }}</td>
            <td>{% if session.fingerprint_verified %}<span class="risk-indicator risk-low"></span>&#10004;{% else %}<span class="risk-indicator risk-high"></span>&#10006;{% endif %}</td>
            <td><span class="risk-indicator risk-{{ session.risk_level|lower }}"></span> {{ session.risk_level }}</td>
          </tr>
          {% empty %}
          <tr><td colspan="6" class="center">No sessions found.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  <div class="card shadow mb-3 glass" style="backdrop-filter: blur(6px);">
    <h3 class="center" style="font-size:1.3em;">Quick Actions</h3>
    <div class="center" style="display:flex;flex-wrap:wrap;gap:1.2em;justify-content:center;">
      <a class="btn" href="{% url 'core:reenroll_face' %}"><span style="margin-right:0.5em;">&#128248;</span>Re-enroll Face</a>
      <a class="btn" href="{% url 'core:reregister_fingerprint' %}"><span style="margin-right:0.5em;">&#128307;</span>Re-register Fingerprint</a>
      <a class="btn" href="{% url 'core:password_change' %}"><span style="margin-right:0.5em;">&#128274;</span>Change Password</a>
    </div>
  </div>
  <div class="card shadow glass" style="backdrop-filter: blur(6px);">
    <h3 class="center" style="font-size:1.3em;">Recent Account Activity</h3>
    <div class="table-responsive">
      <table class="modern-table" style="border-radius:12px;overflow:hidden;">
        <thead>
          <tr style="background:linear-gradient(90deg,#e3e9f7,#f8fafc);">
            <th>Time</th>
            <th>Action</th>
            <th>Details</th>
          </tr>
        </thead>
        <tbody>
          {% for log in audit_logs %}
          <tr>
            <td>{{ log.timestamp|date:'Y-m-d H:i' }}</td>
            <td>{{ log.get_action_display }}</td>
            <td>{{ log.details|truncatechars:40 }}</td>
          </tr>
          {% empty %}
          <tr><td colspan="3" class="center">No recent activity.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
